# Maintainer: kpcyrd <kpcyrd[at]archlinux[dot]org>
# Maintainer: Orhun ParmaksÄ±z <orhun@archlinux.org>
# Maintainer: George Rawlinson <grawlinson@archlinux.org>

pkgname=cargo-sweep
pkgver=0.7.0
pkgrel=1
pkgdesc="A cargo subcommand for cleaning up unused build files generated by Cargo"
url='https://github.com/holmgr/cargo-sweep'
arch=('loong64' 'x86_64')
license=('MIT')
depends=(
  'gcc-libs'
)
makedepends=(
  'cargo'
)
source=(https://github.com/holmgr/${pkgname}/archive/v${pkgver}/${pkgname}-${pkgver}.tar.gz)
sha256sums=('21004272ffacbe19b5e2b6c521a021eb55abd24e96599fc5049c650abb708af2')
b2sums=('312f1133ade85386be11f8dabc347538ca1001583581a621963f819de62147dd6377e037b3ab6faaa434ee07f3febf203afad0b2218059a8cce9e64392226c2b')

prepare() {
  cd "${pkgname}-${pkgver}"
  cargo fetch --locked --target "$(rustc -vV | sed -n 's/host: //p')"
}

build() {
  cd ${pkgname}-${pkgver}
  cargo build --frozen --release
}

package() {
  cd ${pkgname}-${pkgver}

  # binary
  install -vDm755 -t "$pkgdir/usr/bin" target/release/cargo-sweep

  # documentation
  install -vDm644 -t "$pkgdir/usr/share/doc/$pkgname" README.md

  # license
  install -vDm644 -t "$pkgdir/usr/share/licenses/$pkgname" LICENSE
}

# vim: ts=2 sw=2 et:
